
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_PanelLayout.cshtml";
}
<script src="~/Assets/js/customJs/TissueBank/TissueBankController.js"></script>
<script src="~/Assets/js/customJs/TissueBank/TissueBankService.js"></script>
<style>
    .error {
        color: red;
        border-color: red;
    }
</style>
<style>
    table {
        width: 100%;
    }

     @@media only screen and (max-width: 1050px) {
        #mainrow {
            display: none;
        }
    }
    @@media only screen and (min-width: 1051px) {
        #otherrow {
            display: none;
        }
    }

    @@media only screen and (max-width: 1150px) {
        #c1 {
            display: none;
        }
    }
    @@media only screen and (min-width: 1151px) {
        #r1 {
            display: none;
        }
    }

    @@media only screen and (max-width: 1050px) {
        #c2 {
            display: none;
        }
    }
    @@media only screen and (min-width: 1051px) {
        #r2 {
            display: none;
        }
    }

    @@media only screen and (max-width: 1050px) {
        #c3 {
            display: none;
        }
    }
    @@media only screen and (min-width: 1051px) {
        #r3 {
            display: none;
        }
    }

    @@media only screen and (max-width: 950px) {
        #c4 {
            display: none;
        }
    }
    @@media only screen and (min-width: 951px) {
        #r4 {
            display: none;
        }
    }

    @@media only screen and (max-width: 900px) {
        #c5 {
            display: none;
        }
    }
    @@media only screen and (min-width: 901px) {
        #r5 {
            display: none;
        }
    }

    @@media only screen and (max-width: 850px) {
        #c6 {
            display: none;
        }
    }
    @@media only screen and (min-width: 851px) {
        #r6 {
            display: none;
        }
    }
</style>

@if (@ViewBag.user.InfoId != null)
{
    <input type="hidden" for="TissueBankProductMasterId" id="TissueBankProductMasterId" value="@ViewBag.TissueBankProductMasterId" />
    <input type="hidden" for="TissueBankId" id="TissueBankId" value="@ViewBag.user.InfoId" />
    <input type="hidden" for="UserId" id="UserId" value="@ViewBag.user.UserId" />
    <input type="hidden" for="InfoType" id="InfoType" value="@ViewBag.user.InfoType" />
}
else
{
    <input type="hidden" for="TissueBankProductMasterId" id="TissueBankProductMasterId" value="" />
}

<div ng-controller="ProductDetailController">
    <div class="loading-spiner-holder customloader" id="loadingDiv" data-loading>
        <div class="loading-spiner">
            <img src="~/Assets/image/spin.gif" />
        </div>
    </div>
    <ul class="breadcrumb breadcrumb-page">
        <div class="breadcrumb-label text-light-gray">You are here: </div>
        <li>
            <a tabindex="-1" href="@Url.Action("Index", "Home", new { Area = "TissueBank" })">
                <span class="mm-text">Home</span>
            </a>
        </li>
        <li class="active">
            <a tabindex="-1" href="@Url.Action("Index", "Product", new { Area = "TissueBank" })">
                <span class="mm-text"><u>Product Management</u></span>
            </a>
        </li>
        <li class="active"><a href="#">Manage Product</a></li>
    </ul>
    <div class="page-header">
        <div class="row">
            <!-- Page header, center on small screens -->
            <h1 class="col-xs-12 col-sm-4 text-center text-left-sm"> Manage Products</h1>
        </div>
    </div> <!-- / .page-header -->

    <div class="panel" style="margin-bottom:30px">
        <div class="panel-heading">
            <b>Product Details</b>
        </div>
        <div class="panel-body panel-padding">
            <div class="row">
                <div class="col-md-3" style="display:inline-block; margin-bottom:15px">
                    <image ng-if="ProductMaster_TissueBank.ProductMasterImageName!=null" ng-src="~/Assets/image/{{ProductMaster_TissueBank.ProductMasterImageName}}" style="width:200px; height:150px;" />
                    <image ng-if="ProductMaster_TissueBank.ProductMasterImageName==null" src="~/Assets/image/no_product.png" style="width:150px; height:100px;" />
                    @*<image src="~/Assets/image/{{ProductMaster_TissueBank.ProductMasterImageName}}" style="width:200px; height:150px;" />*@
                </div>
                <div class="col-md-9" style="display:inline-block; padding-left:30px">
                    <div style="margin-bottom:10px"><label id="span">Product Name :</label> <span style="padding-left:15px">{{ProductMaster_TissueBank.ProductMasterName}}</span></div>
                    <div style="margin-bottom:10px"><label id="span">Family :</label> <span style="padding-left:15px;">{{ProductMaster_TissueBank.FamilyProductMasterName==null ? 'N/A' : ProductMaster_TissueBank.FamilyProductMasterName}}</span></div>
                    <div style="margin-bottom:10px"><label id="span">Domain Scope :</label> <span style="padding-left:15px;">{{ProductMaster_TissueBank.DomainName}}</span></div>
                    <div style="margin-bottom:10px"><label style="padding-right:10px">Product Description :</label> <span>{{ProductMaster_TissueBank.ProductMasterDescription==null ? 'N/A' : ProductMaster_TissueBank.ProductMasterDescription}}</span></div>
                    <div style="margin-bottom:10px"><label id="span">Product Features :</label> <span style="padding-left:15px;">{{ProductMaster_TissueBank.ProductMasterFeatures==null ? 'N/A' : ProductMaster_TissueBank.ProductMasterFeatures}}</span></div>
                </div>
            </div>
        </div>
    </div>

    <form name="form_ConfirmOnExit" confirm-on-exit>
        <div class="row" style="margin-bottom:10px">
            <div class="col-md-12">
                <span style="font-size:18px">Available Products <b>({{TbProducts.length}})</b></span>
            </div>
        </div>

        <div class="table-header">
            <div class="table-caption">
                <div class="row">
                    <div class="col-md-3">
                        @*<button type="button" class="btn btn-info" ng-show="!editMode" ng-hide="addNewMode" ng-click="editMode=true"><i class="fa fa-plus"></i> Add</button>
                            <button type="button" class="btn btn-danger" ng-show="!editMode" ng-hide="addNewMode" ng-click="editMode=true"><i class="fa fa-pencil-square-o"></i> Edit</button>
                            <button type="button" class="btn btn-info" ng-show="editMode" ng-click="form_ConfirmOnExit.$valid && save()"><i class="fa fa-check"></i> Save</button>
                            <button type="button" class="btn btn-danger" ng-show="editMode" ng-click="cancel()"><i class="fa fa-times"></i> Cancel</button>*@
                        <input ng-show="!editMode" ng-hide="addNewMode" ng-click="editMode=true" type="button" class="btn btn-info" value="Add/Edit" />
                        <input ng-show="editMode" ng-click="cancel()" type="button" class="btn btn-danger" value="Cancel" />
                        <button ng-show="editMode" ng-click="form_ConfirmOnExit.$valid && save()" class="btn btn-info">Save</button>
                    </div>
                    <span ng-show="editMode" style="float: right;font-size: 12px;color: #2175ac;">In Case of non availability of required Product type, kindly contact Allocat support.</span>
                </div>
            </div>
        </div>

        <table class="table table-hover" id="tablestyle" style="text-align:left">
            <thead id="headerstyle">
                <tr>
                    <th></th>
                    <th>Product Type</th>
                    <th id="c5">Size</th>
                    <th id="c4">Product Code</th>
                    <th id="c3">Preservation Type</th>
                    <th id="c6">Unit Price($)</th>
                    <th id="c2">Available For Sale</th>
                    <th id="c1">Source</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat-start="Product in TbProducts">
                    <td style="vertical-align:middle">
                        <button class="icn" ng-if="Product.expanded" ng-click="Product.expanded = false" id="button1">-</button>
                        <button class="icn" ng-if="!Product.expanded" ng-click="Product.expanded = true" id="button2">+</button>
                    </td>
                    <td style="vertical-align:middle">
                        <span ng-hide="editMode">{{Product.ProductType}}</span>
                        <select ng-hide="!editMode" ng-model="Product.ProductType" ng-change="CheckTypeCombination(Product.ProductType,Product.ProductSize,$index)" ng-required="true" ng-options="ProductTypeOption for ProductTypeOption in ProductTypeOptions">
                            <option value="" label="-ProductType-"></option>
                        </select>
                    </td>
                    <td id="c5" style="vertical-align:middle; width:15%">
                        <span ng-hide="editMode">{{Product.ProductSize}}</span>
                        <select ng-hide="!editMode" ng-model="Product.ProductSize" ng-change="CheckSizeCombination(Product.ProductType,Product.ProductSize,$index)" required ng-options="ProductSizeOptions for ProductSizeOptions in ProductSizeOptions">
                            <option value="" label="-ProductSize-"></option>
                        </select>
                    </td>
                    <td id="c4" style="vertical-align:middle">
                        <span ng-hide="editMode">{{Product.ProductCode}}</span>
                        <input ng-hide="!editMode" ng-model="Product.ProductCode" ng-pattern="ProductCodeExp" placeholder="Enter ProductCode" required>
                    </td>
                    <td id="c3" style="vertical-align:middle">
                        <span ng-hide="editMode">{{Product.PreservationType}}</span>
                        <select ng-hide="!editMode" ng-model="Product.PreservationType" required ng-options="PreservationTypeOption for PreservationTypeOption in PreservationTypeOptions">
                            <option value="" label="-PreservationType-"></option>
                        </select>
                    </td>
                    <td id="c6" style="vertical-align:middle">
                        <span ng-hide="editMode">{{Product.UnitPrice==null ? 'N/A' : Product.UnitPrice | currency}}</span>
                        <input ng-hide="!editMode" ng-model="Product.UnitPrice" placeholder="Enter Unit Price" type="number" />
                    </td>
                    <td id="c2" style="vertical-align:middle; width:9%">
                        <span ng-hide="editMode">{{Product.IsAvailableForSale}}</span>
                        <select ng-hide="!editMode" ng-model="Product.IsAvailableForSale" required ng-change="print(Product.IsAvailableForSale)" ng-options="IsAvailableOption for IsAvailableOption in IsAvailableOptions">
                            <option value="" label="-Availability-"></option>
                        </select>
                    </td>
                    <td id="c1" style="vertical-align:middle">
                        <span ng-hide="editMode">{{Product.SourceName}}</span>
                        <select ng-hide="!editMode" ng-model="Product.SourceId" required ng-options="value.SourceId as value.SourceName for (key, value) in SourceOptions">
                            <option value="" label="-Source-"></option>
                        </select>
                    </td>
                </tr>
                <tr ng-if="Product.expanded" ng-repeat-end="">
                    <td colspan="8">
                        <div class="row">
                            <div class="col-md-6">
                                <table class="table table-hover" id="mainrow">
                                    <tr>
                                        <td><b>Product Description :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.ProductDescription}}</span>
                                            <input ng-hide="!editMode" ng-model="Product.ProductDescription" placeholder="Enter Product Description" type="text" />
                                        </td>
                                    </tr>
                                    <tr id="r1">
                                        <td><b>Source :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.SourceName}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.SourceId" required ng-options="value.SourceId as value.SourceName for (key, value) in SourceOptions">
                                                <option value="" label="-Source-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r2">
                                        <td><b>Available For Sale :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.IsAvailableForSale}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.IsAvailableForSale" required ng-change="print(Product.IsAvailableForSale)" ng-options="IsAvailableOption for IsAvailableOption in IsAvailableOptions">
                                                <option value="" label="-Availability-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r3">
                                        <td><b>Preservation Type :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.PreservationType}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.PreservationType" required ng-options="PreservationTypeOption for PreservationTypeOption in PreservationTypeOptions">
                                                <option value="" label="-PreservationType-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r4">
                                        <td><b>Product Code :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.ProductCode}}</span>
                                            <input ng-hide="!editMode" ng-model="Product.ProductCode" ng-pattern="ProductCodeExp" placeholder="Enter ProductCode" required>
                                        </td>
                                    </tr>
                                    <tr id="r5">
                                        <td><b>Size :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.ProductSize}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.ProductSize" required ng-options="ProductSizeOptions for ProductSizeOptions in ProductSizeOptions">
                                                <option value="" label="-ProductSize-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r6">
                                        <td><b>Unit Price :</b></td>
                                        <td>
                                            <span ng-hide="editMode">{{Product.UnitPrice==null ? 'N/A' : Product.UnitPrice | currency}}</span>
                                            <input ng-hide="!editMode" ng-model="Product.UnitPrice" placeholder="Enter Unit Price" type="number" />
                                        </td>
                                    </tr>
                                </table>

                                <table class="table table-hover table-striped" id="otherrow">
                                    <tr>
                                        <td><b>Product Description :</b></td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span ng-hide="editMode">{{Product.ProductDescription}}</span>
                                            <input ng-hide="!editMode" ng-model="Product.ProductDescription" placeholder="Enter Product Description" type="text" />
                                        </td>
                                    </tr>
                                    <tr id="r1">
                                        <td><b>Source :</b></td>
                                    </tr>
                                    <tr id="r1">
                                        <td>
                                            <span ng-hide="editMode">{{Product.SourceName}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.SourceId" required ng-options="value.SourceId as value.SourceName for (key, value) in SourceOptions">
                                                <option value="" label="-Source-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r2">
                                        <td><b>Available For Sale :</b></td>
                                    </tr>
                                    <tr id="r2">
                                        <td>
                                            <span ng-hide="editMode">{{Product.IsAvailableForSale}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.IsAvailableForSale" required ng-change="print(Product.IsAvailableForSale)" ng-options="IsAvailableOption for IsAvailableOption in IsAvailableOptions">
                                                <option value="" label="-Availability-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r3">
                                        <td><b>Preservation Type :</b></td>
                                    </tr>
                                    <tr id="r3">
                                        <td>
                                            <span ng-hide="editMode">{{Product.PreservationType}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.PreservationType" required ng-options="PreservationTypeOption for PreservationTypeOption in PreservationTypeOptions">
                                                <option value="" label="-PreservationType-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r4">
                                        <td><b>Product Code :</b></td>
                                    </tr>
                                    <tr id="r4">
                                        <td>
                                            <span ng-hide="editMode">{{Product.ProductCode}}</span>
                                            <input ng-hide="!editMode" ng-model="Product.ProductCode" ng-pattern="ProductCodeExp" placeholder="Enter ProductCode" required>
                                        </td>
                                    </tr>
                                    <tr id="r5">
                                        <td><b>Size :</b></td>
                                    </tr>
                                    <tr id="r5">
                                        <td>
                                            <span ng-hide="editMode">{{Product.ProductSize}}</span>
                                            <select ng-hide="!editMode" ng-model="Product.ProductSize" required ng-options="ProductSizeOptions for ProductSizeOptions in ProductSizeOptions">
                                                <option value="" label="-ProductSize-"></option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr id="r6">
                                        <td><b>Unit Price :</b></td>
                                    </tr>
                                    <tr id="r6">
                                        <td>
                                            <span ng-hide="editMode">{{Product.UnitPrice==null ? 'N/A' : Product.UnitPrice | currency}}</span>
                                            <input ng-hide="!editMode" ng-model="Product.UnitPrice" placeholder="Enter Unit Price" type="number" />
                                        </td>
                                    </tr>
                                </table>

                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="form-group">
            @*<input ng-hide="!TbProducts.length || !editMode" type="button" class="btn btn-danger pull-right" ng-click="remove()" value="Remove">*@
            <button ng-hide="!editMode" ng-click="form_ConfirmOnExit.$valid && addNew()" class="btn btn-info addnew pull-right" style="margin-top:10px">Add New</button>
        </div>
    </form>
    <div class="notifies" notifybar></div>
</div>

<modal id="myModal" class="modal fade" role="dialog" visible="showModal">
    <!-- template for modal -->
    <div class="form-group">
        @*<div class="col-md-6">Tissue Bank</div>
            <div class="col-md-6">{{tissueBank.tissueBank.TissueBankName}}</div>*@
        <div class="col-md-12">
            <textarea style="width:100%" ng-model="selectedDescription"> </textarea>
        </div>
        <div class="col-md-12">
            <input type="button" class="btn btn-primary" ng-click="ok()" value="OK" />
            <input type="button" class="btn btn-warning" ng-click="cancel()" value="Cancel" />
        </div>
    </div>

</modal>
<script type="text/ng-template" id="firstDialogId">
    <div class="ngdialog-message">
        <h3>Add/Edit Description</h3>
        <textarea style="width:100%" ng-model="ngDialogData.selectedDescription"> </textarea>
    </div>
    <div class="ngdialog-buttons">
        <button type="button" class="ngdialog-button ngdialog-button-primary"
                ng-click="Submit()">
            Submit
        </button>
        <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="Cancel()">Cancel</button>
    </div>
</script>
