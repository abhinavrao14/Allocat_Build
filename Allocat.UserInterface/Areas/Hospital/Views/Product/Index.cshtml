@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_PanelLayout.cshtml";
}
<script src="~/Assets/js/customJs/Hospital/HospitalController.js"></script>
<script src="~/Assets/js/customJs/Hospital/HospitalService.js"></script>
<style>
    table {
        width: 100%;
    }

    @@media only screen and (min-width: 801px) {
        .othertable {
            display: none;
        }
    }

    @@media only screen and (max-width: 800px) {
        .maintable {
            display: none;
        }
    }

    @@media only screen and (min-width: 651px) {
        .icn {
            display: none;
        }
    }

    @@media only screen and (max-width: 650px) {
        #c1 {
            display: none;
        }
    }

    @@media only screen and (min-width: 651px) {
        #r1 {
            display: none;
        }
    }

    @@media only screen and (max-width: 600px) {
        #c2 {
            display: none;
        }
    }

    @@media only screen and (min-width: 601px) {
        #r2 {
            display: none;
        }
    }

    @@media only screen and (max-width: 550px) {
        #c3 {
            display: none;
        }
    }

    @@media only screen and (min-width: 551px) {
        #r3 {
            display: none;
        }
    }
</style>

<div ng-controller="ProductHospitalController">
    <div class="loading-spiner-holder customloader" id="loadingDiv" data-loading>
        <div class="loading-spiner">
            <img src="~/Assets/image/spin.gif" />
        </div>
    </div>
    <input type="hidden" for="InfoId" id="InfoId" value="@ViewBag.user.InfoId" />
    <input type="hidden" for="InfoType" id="InfoType" value="@ViewBag.user.InfoType" />


    <ul class="breadcrumb breadcrumb-page">
        <div class="breadcrumb-label text-light-gray">You are here: </div>
        <li><a tabindex="-1" href="@Url.Action("Index", "Home", new { Area = "Hospital" })"><u>Home</u></a></li>
        <li class="active"><a href="#">Product Management</a></li>
    </ul>

    <div class="page-header">
        <div class="row">
            <h1 class="col-xs-12 col-sm-4 text-center text-left-sm">Products</h1>
        </div>
    </div>
    <div class="panel" ng-if="dataLoading!=true">
        <div class="panel-heading" style="background-color:#bfccdc; border:1px solid #bfccdc; padding-bottom:0px">
            <div class="row">
                <div class="col-md-4" id="title" style="font-size:15px; font-weight:600">
                    Products Available ({{AllProductMasters.length>0 ? AllProductMasters.length : 0}})
                </div>
                <div class="col-md-8" style="margin-bottom:30px; border-right:1px solid #8ba4c2; height:31px;">
                    &nbsp;
                    <div layout="column" ng-cloak="" class="autocompletedemoBasicUsage" style="margin-top:-22px">
                        <md-content class="md-padding">
                            <form ng-submit="$event.preventDefault()">
                                <md-autocomplete md-no-cache="false"
                                                 md-selected-item="selectedItem"
                                                 md-search-text="searchText"
                                                 md-items="item in querySearch(searchText)"
                                                 md-item-text="item.display"
                                                 md-search-text-change="searchTextChange(searchText)"
                                                 md-selected-item-change="selectedItemChange(item)"
                                                 md-min-length="0"
                                                 placeholder="Search for products here!.">
                                    <md-item-template>
                                        <span md-highlight-text="searchText" md-highlight-flags="^i">{{item.display}}</span>
                                    </md-item-template>
                                    <md-not-found>
                                        No matching "{{searchText}}" were found.
                                    </md-not-found>
                                </md-autocomplete>
                            </form>
                        </md-content>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel-body panel-padding">
            <div ng-if="(ProductVariations.length==0 && dataLoading) || ProductVariations.length==0" style="color:darkgreen;">No products are available.</div>
            <div ng-if="ProductVariations.length!=0 && !dataLoading && ProductVariations!=null" class="row">

                <div class="panel-group panel-group-default">
                    <div class="panel">
                        <div class="panel-heading">
                            <div class="col-md-8">
                                ProductMasterDetail : {{ProductMasterDetail.ProductMasterName}}<br />
                                ProductMasterDescription : {{ProductMasterDetail.ProductMasterDescription}}<br />
                                ProductMasterFeatures : {{ProductMasterDetail.ProductMasterFeatures}}<br />
                                DomainName : {{ProductMasterDetail.DomainName}}<br />
                                FamilyProductMasterName : {{ProductMasterDetail.FamilyProductMasterName}}<br />
                            </div>
                            <div class="col-md-4">
                                <image ng-if="ProductMasterDetail.ProductMasterImageName!=null" ng-src="~/Assets/image/{{ProductMasterDetail.ProductMasterImageName}}" style="width:200px; height:150px;" />
                                <image ng-if="ProductMasterDetail.ProductMasterImageName==null" src="~/Assets/image/no_product.png" style="width:150px; height:100px; margin-left:25px;" /><br />
                            </div>
                        </div>
                        <div class="panel-body">
                            Product Variations Available for {{SelectedProductMaster}} : {{ProductVariations.length}}
                            <table class="table table-striped maintable" id="tablestyle">
                                <thead style="background-color: #52606f; color: #ffffff;">
                                    <tr>
                                        <th style="text-align:center">Product Types</th>
                                        <th style="text-align:center">Variations</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="ProductVariation in ProductVariations | unique:'ProductType'">
                                        <td style="vertical-align:middle; font-weight: 600;">{{ProductVariation.ProductType}}</td>
                                        <td>
                                            <table class="table table-hover table-striped" id="tablestyle">
                                                <thead style="background-color: #5e6e80; color: #ffffff;">
                                                    <tr>
                                                        <th style="text-align:center">Product Size</th>
                                                        <th style="text-align:center">Preservation Type</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {{ProductVariation.ProductMasterName}}
                                                    <tr ng-repeat="SubProductVariation in ProductVariations | filter:{'ProductType': ProductVariation.ProductType}:true">
                                                        @{
                                                            var url = Url.Action("Manage", "Product", new
                                                            {
                                                                ProductMasterName = "{{ProductMasterName=SearchBy}}",
                                                                ProductType = "{{ProductType=ProductVariation.ProductType}}",

                                                                ProductSize = "{{ProductSize=SubProductVariation.ProductSize}}",

                                                                PreservationType = "{{PreservationType=SubProductVariation.PreservationType}}",

                                                                SourceName = "{{SourceName=SubProductVariation.SourceName}}",
                                                            });
                                                            url = HttpUtility.UrlDecode(url);
                                                        }
                                                        <td><a data-ng-href="@url">{{SubProductVariation.ProductSize}}</a></td>
                                                        <td><a data-ng-href="@url">{{SubProductVariation.PreservationType}}</a></td>
                                                        <td><a data-ng-href="@url">{{SubProductVariation.SourceName}}</a></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>

                            <table class="table table-hover othertable" id="tablestyle">
                                <tbody>
                                    <tr ng-repeat="ProductVariation in ProductVariations | unique:'ProductType'">
                                        <td>
                                            <label>Product Type :</label> {{ProductVariation.ProductType}}
                                            <table class="table table-default" id="tablestyle" style="text-align:left">
                                                <thead style="background-color: #5e6e80; color: #ffffff;">
                                                    <tr>
                                                        <th></th>
                                                        <th>Product Size</th>
                                                        <th id="c2">Preservation Type</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat-start="SubProductVariation in ProductVariations | filter:{'ProductType': ProductVariation.ProductType}:true">
                                                        <td>
                                                            <button class="icn" ng-if="SubProductVariation.expanded" ng-click="SubProductVariation.expanded = false" id="button1">-</button>
                                                            <button class="icn" ng-if="!SubProductVariation.expanded" ng-click="SubProductVariation.expanded = true" id="button2">+</button>
                                                        </td>
                                                        <td>{{SubProductVariation.ProductSize}}</td>
                                                        <td id="c2">{{SubProductVariation.PreservationType}}</td>
                                                    </tr>
                                                    <tr ng-if="SubProductVariation.expanded" ng-repeat-end="">
                                                        <td colspan="4">
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <table class="table table-hover">
                                                                        <tr id="r2">
                                                                            <td><b>Preservation Type:</b></td>
                                                                            <td><i>{{SubProductVariation.PreservationType}}</i></td>
                                                                        </tr>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    @*product substitute*@
    <div class="panel" ng-if="ProductVariations.length!=0 && !dataLoading && ProductVariations!=null">
        Total Product Substitutes({{TotalProductSubstitutes>0 ? TotalProductSubstitutes : 0 | unique:'ProductMasterId'}})
        @*<div class="panel-heading" style="background-color:#bfccdc; border:1px solid #bfccdc; padding-bottom:0px">
                <div class="row">
                    <div class="col-md-6" id="title" style="font-size:15px; font-weight:600">
                        Total Product Substitutes({{TotalProductSubstitutes>0 ? TotalProductSubstitutes : 0}})
                    </div>
                    <div class="col-md-3" style="font-size:15px; margin-bottom:10px">
                        <label class="filter-col" for="pref-perpage">Per Page: </label>
                        <select class="form-control" style="width:45%" id="select" ng-disabled="TotalProductSubstitutes<1" ng-options="item for item in PageSizes" ng-model="PageSize" ng-change="PageSizeChanged()"></select>
                    </div>
                    <div class="col-md-3" style="margin-bottom:10px">
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getFirstPage()" ng-disabled="CurrentPage<=1" value="««" /></a>
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getPreviousPage()" ng-disabled="CurrentPage<=1" value="«" /></a>
                        <span id="page">{{CurrentPage}}/{{TotalPage}}</span>
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getNextPage()" ng-disabled="CurrentPage*PageSize>TotalProductSubstitutes" value="»" /></a>
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getLastPage()" ng-disabled="CurrentPage*PageSize>TotalProductSubstitutes" value="»»" /></a>
                    </div>

                </div>
            </div>*@

        <div class="panel-body">
            <div class="table-responsive table-primary">
                <div ng-if="ProductSubstitutes.length==0" class="panel panel-default alert alert-danger">
                    Sorry..No Product Substitutes.
                </div>

                <table class="table table-bordered table-hover table-striped" id="table" ng-if="ProductSubstitutes.length!=0">
                    <thead>
                        <tr>
                            <th>Product Master</th>
                            <th>Product Types & Its Variations</th>
                            <th>Image</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="Product in ProductSubstitutes | unique:'ProductMasterId'">
                            <td style="background-color:#7e8590; color:#ffffff; text-align:center;width:20%">{{Product.ProductMasterName}}</td>
                            <td style="padding-right: 0px;">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>Product Type</th>
                                            <th>Variations</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="SubProduct in ProductSubstitutes | unique:'ProductType' | filter:{'ProductMasterId':  Product.ProductMasterId}:true">
                                            <td><b>{{SubProduct.ProductType}}</b></td>
                                            <td style="padding-right: 0px;">
                                                <table class="table table-bordered table-hover table-striped">
                                                    <thead>
                                                        <tr>
                                                            <th>Product Size</th>
                                                            <th>Preservation Type</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="SuperSubProduct in ProductSubstitutes | filter:{'ProductType':  SubProduct.ProductType}:true">
                                                            <td>{{SuperSubProduct.ProductSize}}</td>
                                                            <td>{{SuperSubProduct.PreservationType}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                            <td>
                                <image ng-if="Product.ProductMasterImageName!=null" ng-src="~/Assets/image/{{Product.ProductMasterImageName}}" style="width:200px; height:150px;" />
                                <image ng-if="Product.ProductMasterImageName==null" src="~/Assets/image/no_product.png" style="width:150px; height:100px; margin-left:25px;" />
                            </td>
                        </tr>
                </table>
            </div>
        </div>
        @*<div class="table-footer" style="background-color:#bfccdc; border:1px solid #bfccdc">
                <div class="row">
                    <div class="col-md-3" style="float:right">
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getFirstPage()" ng-disabled="CurrentPage<=1" value="««" /></a>
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getPreviousPage()" ng-disabled="CurrentPage<=1" value="«" /></a>
                        <span id="page">{{CurrentPage}}/{{TotalPage}}</span>
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getNextPage()" ng-disabled="CurrentPage*PageSize>TotalProductSubstitutes" value="»" /></a>
                        <a href="#"><input type="button" class="btn btn-flat" id="pagination" ng-click="getLastPage()" ng-disabled="CurrentPage*PageSize>TotalProductSubstitutes" value="»»" /></a>
                    </div>
                </div>
            </div>*@
    </div>

    <div class="notifies" notifybar></div>
</div>
